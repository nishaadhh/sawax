<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAWAX | Premium Watches</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" 
          integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" 
          crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Fav Icon -->
    <link rel="icon" type="image/x-icon" href="/img/fav-icon.png">

<style>
    :root {
        --primary: #1a1a1a;
        --secondary: #f8f8f8;
        --accent: #ffc400;
        --text: #333;
        --light-text: #777;
        --border: #e0e0e0;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Poppins', 'Helvetica Neue', Arial, sans-serif;
    }

    body {
        color: var(--text);
        background-color: var(--secondary);
    }

    a {
        text-decoration: none;
        color: inherit;
    }

    .container {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
    }

   
    header {
        background-color: white;
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 0;
    }

.logo:hover .logo-shiny {
  animation-play-state: paused;
}

.logo {
  display: inline-block;
  font-family: "Poppins", sans-serif;
  font-size: 2.2rem;
  font-weight: 700;
  color: #ffc400;
  cursor: pointer;
  transition: transform 0.3s ease, text-shadow 0.3s ease;
}


.logo:hover {
  transform: scale(1.08);
  /* text-shadow: 0 0 12px rgba(255, 196, 0, 0.6),
               0 0 24px rgba(255, 196, 0, 0.3); */
}


.logo:hover .logo-shiny {
  animation: none;
  background: none;
  -webkit-text-fill-color: #ffc400;
  color: #ffc400;
}


.logo-shiny {
  color: inherit;
  background: linear-gradient(
    120deg,
    rgba(255, 255, 255, 0) 40%,
    #ffc400 50%,
    rgba(255, 255, 255, 0) 60%
  );
  background-size: 200% 100%;
  -webkit-background-clip: text;
  background-clip: text;
  display: inline-block;
  -webkit-text-fill-color: transparent;
  animation: shine 5s linear infinite; 
}


@keyframes shine {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}


.logo-link {
  text-decoration: none;
  color: inherit;
}



    nav ul {
        display: flex;
        list-style: none;
        gap: 30px;
        margin: 0;
        padding: 0;
        align-items: center;
    }

    nav ul li a {
        font-weight: 500;
        font-size: 16px;
        transition: color 0.3s;
        color: #747474;
    }

    nav ul li a:hover {
        color: #000000;
    }

    .header-icons {
        display: flex;
        gap: 20px;
        align-items: center;
    }

    .header-icon {
        cursor: pointer;
        font-size: 20px;
        transition: color 0.3s;
        color: #747474;
    }

    .header-icon:hover {
        color: #ffc400;
    }

    
    .dropdown {
        position: relative;
        display: inline-flex;
        align-items: center;
    }

    .sign-in-link {
        color: #ffc400;
        font-weight: 500;
        font-size: 16px;
        transition: color 0.3s;
    }

    .sign-in-link:hover {
        color: #000000;
    }

    .dropdown-content {
        display: none;
        position: absolute;
        background-color: white;
        min-width: 160px;
        box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        z-index: 1000;
        right: 0;
        border-radius: 4px;
        opacity: 0;
        transform: translateY(10px);
        transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .dropdown:hover .dropdown-content {
        display: block;
        opacity: 1;
        transform: translateY(0);
    }

    .dropdown-content a {
        color: #ffc400;
        padding: 12px 16px;
        display: block;
        font-size: 14px;
        transition: background-color 0.3s;
    }

    .dropdown-content a:hover {
        background-color: var(--secondary);
        border-radius: 4px;
    }

    /* Mobile Menu */
    .mobile-menu {
        display: none;
        font-size: 24px;
        cursor: pointer;
        transition: color 0.3s;
    }

    .mobile-menu:hover {
        color: var(--accent);
    }

    .mobile-nav {
        display: none;
        background-color: rgb(0, 0, 0);
        position: absolute;
        top: 100%;
        left: 0;
        width: 100%;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        z-index: 999;
        padding: 20px;
        transform: translateY(-10px);
        opacity: 0;
        transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .mobile-nav.active {
        display: block;
        opacity: 1;
        transform: translateY(0);
    }

    .mobile-nav ul {
        flex-direction: column;
        gap: 15px;
    }

    .mobile-nav ul li a {
        display: block;
        padding: 10px;
        font-size: 16px;
        color: var(--text);
        transition: background-color 0.3s, color 0.3s;
    }

    .mobile-nav ul li a:hover {
        background-color: var(--secondary);
        color: var(--accent);
        border-radius: 4px;
    }

    /* Responsive */
    @media (max-width: 992px) {
        nav ul {
            display: none;
        }
        .mobile-menu {
            display: block;
        }
        .header-icons {
            gap: 15px;
        }
    }

    @media (max-width: 768px) {
        .logo { font-size: 28px; }
        .header-icon { font-size: 18px; }
        .mobile-menu { font-size: 22px; }
    }

    @media (max-width: 576px) {
        .logo { font-size: 24px; }
        .header-content { padding: 15px 0; }
        .header-icons { gap: 10px; }
        .header-icon { font-size: 16px; }
        .mobile-menu { font-size: 20px; }
        .mobile-nav { padding: 15px; }
    }

            .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header */
        header {
            background-color: rgb(0, 0, 0);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }
        
        .logo {
            font-size: 32px;
            font-weight: 700;
            letter-spacing: 3px;
            color: var(--primary);
        }
        
        .logo span {
            color: var(--accent);
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 30px;
        }
        
        nav ul li a {
            font-weight: 500;
            transition: color 0.3s;
            font-size: 16px;
        }
        
        nav ul li a:hover {
            color: var(--accent);
        }
        
        .header-icons {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .header-icon {
            cursor: pointer;
            font-size: 20px;
            transition: color 0.3s;
        }
        
        .header-icon:hover {
            color: var(--accent);
        }
        
        .mobile-menu {
            display: none;
            font-size: 24px;
            cursor: pointer;
        }

        .mobile-dropdown.active .mobile-dropdown-content { display: block; }
        .mobile-dropdown-content { display: none; background: white; margin-top: 10px; border-radius: 6px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .mobile-dropdown-content a { padding: 12px 20px; display: block; }
</style>

</head>
<body>

<!-- Header -->
<header>
    <div class="container">
        <div class="header-content">
            <div class="logo" ><a href="/" class="logo-shiny">SA<span class="logo-shiny">WAX</span></a></div>
            
            <nav>
                <ul>
                    <li><a href="/" >Home</a></li>
                    <li><a href="/shop" >Shop</a></li>
                    <li><a href="/about" >About</a></li>

                    <% if (user) { %>
                        <li class="dropdown">
                            <a href="#" class="sign-in-link" style="color: rgb(255, 191, 0);"><%= user ? user.name : "" %>
</a>
                            <div class="dropdown-content">
                                <a href="#" style="color: red;" onclick="confirmLogout()">
                                    <i class="fas fa-sign-out-alt"></i> Logout
                                </a>
                            </div>
                        </li>
                    <% } else { %>
                        <li><a href="/login" style="color: #DF8A00">Login</a></li>
                        <li><a href="/signup" style="color: #DF8A00">Signup</a></li>
                    <% } %>
                </ul>
            </nav>

            <div class="header-icons">
                <a class="header-icon" href="/profile"><i class="fa-solid fa-circle-user"></i></a>
                <a class="header-icon" href="/wishlist"><i class="fa-solid fa-heart"></i></a>
                <a class="header-icon" href="/cart" style="position: relative;">
                    <i class="fa-solid fa-cart-shopping"></i>
                    <span id="nav-cart-count" style="display:none; position: absolute; top: -6px; right: -10px; background: #fabf00; color: #000; border-radius: 999px; padding: 0 6px; font-size: 11px; font-weight: 700; line-height: 18px; min-width: 18px; text-align: center;">0</span>
                </a>
                <a class="header-icon" href="/orders"><i class="fa-brands fa-shopify"></i></a>
                <a class="header-icon" href="/wallet"><i class="fa-solid fa-wallet"></i></a>
                <div class="mobile-menu">â˜°</div>
            </div>
        </div>
    </div>

    <!-- Mobile Navigation -->
    <div class="mobile-nav" id="mobile-nav">
        <ul>
            <li><a href="/"><i class="fa-solid fa-house"></i>   Home</a></li>
            <li><a href="/shop"><i class="fa-solid fa-shop"></i>   Shop</a></li>
            <li><a href="/about"><i class="fa-regular fa-copyright"></i> About</a></li>

<!-- Mobile Account Dropdown - REPLACE THIS WHOLE <li> -->
<li class="mobile-dropdown">
    <% if (user) { %>
        <a href="#" onclick="toggleMobileDropdown(event)" style="color: #fabf00;">
            <i class="fa-solid fa-circle-user"></i> <%= user.name %>
        </a>
        <div class="mobile-dropdown-content">
            <a href="/profile">Profile</a>
            <a href="#" onclick="confirmLogout()" style="color: red;">Logout</a>
        </div>
    <% } else { %>
        <a href="#" onclick="toggleMobileDropdown(event)" style="color: #fabf00;">
            <i class="fa-solid fa-circle-user"></i> Account
        </a>
        <div class="mobile-dropdown-content">
            <a href="/login" style="color: #DF8A00">Login</a>
            <a href="/signup" style="color: #DF8A00">Signup</a>
        </div>
    <% } %>
</li>
        </ul>
    </div>
</header>


<script>
    // Mobile Menu Toggle
    const mobileMenu = document.querySelector('.mobile-menu');
    const mobileNav = document.querySelector('#mobile-nav');

    mobileMenu.addEventListener('click', () => {
        mobileNav.classList.toggle('active');
    });


    function toggleMobileDropdown(e) {
    e.preventDefault();
    e.stopPropagation();
    const dropdown = e.target.closest('.mobile-dropdown');
    document.querySelectorAll('.mobile-dropdown').forEach(d => d.classList.toggle('active', d === dropdown));
}
    
    function toggleMobileDropdown(event) {
        event.preventDefault();
        const dropdown = event.target.closest('.mobile-dropdown');
        dropdown.classList.toggle('active');
    }

    // Close mobile menu when clicking outside
    document.addEventListener('click', (e) => {
        if (!mobileNav.contains(e.target) && !mobileMenu.contains(e.target)) {
            mobileNav.classList.remove('active');
        }
    });

    // Logout Confirmation with SweetAlert2
    function confirmLogout() {
        Swal.fire({
            title: 'Are you sure?',
            text: "Do you want to logout?",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Yes, Logout',
            cancelButtonText: 'Cancel',
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33'
        }).then((result) => {
            if (result.isConfirmed) {
                fetch('/logout', { method: 'GET' })
                    .then(res => {
                        if (res.redirected) {
                            window.location.href = res.url;
                        } else {
                            window.location.reload();
                        }
                    })
                    .catch(() => window.location.reload());
            }
        });
    }

    //  Cart Count 
    const cartBadge = document.getElementById('nav-cart-count');

    async function fetchCartCount() {
        try {
            const res = await fetch('/cart/count', {
                method: 'GET',
                credentials: 'same-origin',
                headers: { 'X-Requested-With': 'XMLHttpRequest' }
            });

            if (!res.ok) return;

            const data = await res.json();
            const count = (data && data.success) ? (data.count ?? 0) : 0;

            if (count > 0) {
                cartBadge.textContent = count;
                cartBadge.style.display = 'inline-block';
            } else {
                cartBadge.style.display = 'none';
            }
        } catch (err) {
            console.warn('Cart count fetch failed:', err);
        }
    }

    
    fetchCartCount();

    
    const POLL_INTERVAL = 5000;
    const pollTimer = setInterval(fetchCartCount, POLL_INTERVAL);

    
    document.addEventListener('visibilitychange', () => {
        if (!document.hidden) fetchCartCount();
    });

    
    window.addEventListener('beforeunload', () => clearInterval(pollTimer));
</script>

</body>
</html>